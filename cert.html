<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GDG Certificate Verification</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Google Sans', sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; display: flex; justify-content: center; min-height: 100vh; }
        .container { background: white; width: 100%; max-width: 900px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); overflow: hidden; display: flex; flex-direction: column; height: fit-content; }
        
        /* Header */
        .header { background: #fff; padding: 20px 30px; border-bottom: 1px solid #eee; display: flex; align-items: center; justify-content: space-between; }
        .logo { height: 35px; }

        /* Content Layout */
        .content { display: grid; grid-template-columns: 1fr; gap: 30px; padding: 30px; }
        @media(min-width: 768px) { .content { grid-template-columns: 1.5fr 1fr; } }

        /* Left: PDF Preview */
        .preview-box { background: #eee; border-radius: 8px; overflow: hidden; aspect-ratio: 16/9; border: 1px solid #ddd; }
        iframe { width: 100%; height: 100%; border: none; }

        /* Right: Details */
        .details h2 { margin: 0 0 5px 0; color: #202124; font-size: 24px; }
        .meta { color: #5f6368; font-size: 14px; margin-bottom: 25px; }
        
        .verified-tag { display: inline-flex; align-items: center; gap: 6px; color: #188038; background: #e6f4ea; padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 600; margin-bottom: 15px; }

        /* Buttons */
        .btn { display: flex; align-items: center; justify-content: center; width: 100%; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: 500; margin-bottom: 12px; transition: 0.2s; box-sizing: border-box; font-size: 15px; cursor: pointer;}
        
        .btn-google { border: 1px solid #dadce0; color: #3c4043; background: white; }
        .btn-google:hover { background: #f1f3f4; }

        .btn-linkedin { background-color: #0077B5; color: white; border: none; }
        .btn-linkedin:hover { background-color: #006097; }

        .btn-download { background-color: #4285F4; color: white; border: none; }
        .btn-download:hover { background-color: #3367D6; }

        /* Loader & Errors */
        #loader { text-align: center; padding: 60px; color: #666; font-size: 18px; }
        .hidden { display: none !important; }
        .error { color: #d93025; text-align: center; padding: 40px; }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="Group 116.png" class="logo" alt="Google Logo">
        <span style="color: #5f6368; font-size: 14px;">Certificate Verification</span>
    </div>

    <div id="loader">Verifying Credential...</div>
    <div id="error" class="error hidden"></div>

    <div id="result" class="content hidden">
        <div class="preview-box">
            <iframe id="cert-frame" src=""></iframe>
        </div>

        <div class="details">
            <div class="verified-tag">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                Officially Verified
            </div>

            <h2 id="name">Student Name</h2>
            <div class="meta">
                ID: <span id="cert-id"></span> &bull; Issued: <span id="date"></span>
            </div>

            <a id="btn-linkedin" href="#" target="_blank" class="btn btn-linkedin">
                <svg style="margin-right:8px;" width="16" height="16" viewBox="0 0 24 24" fill="white"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                Add to LinkedIn Profile
            </a>

            <a id="btn-profile" href="#" target="_blank" class="btn btn-google">
                Verify on Google Skills Boost
            </a>

            <a id="btn-download" href="#" class="btn btn-download">
                Download PDF
            </a>
        </div>
    </div>
</div>

<script>
    // --- PASTE YOUR WEB APP URL HERE ---
    const API_URL = "https://script.google.com/macros/s/AKfycbxhjwIYboNHHkBAMPStorZOz0EJzJvGzaL2qNcRn-CwQyFRRlCZGEKInOchNTZJM1C_Kg/exec"; 
    // -----------------------------------

    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    if (!id) {
        showError("No Certificate ID provided in the URL.");
    } else {
        fetch(`${API_URL}?id=${id}`)
            .then(res => res.json())
            .then(data => {
                document.getElementById('loader').classList.add('hidden');
                
                if (data.valid) {
                    document.getElementById('result').classList.remove('hidden');
                    
                    // Fill Text
                    document.getElementById('name').innerText = data.name;
                    document.getElementById('cert-id').innerText = data.certId;
                    document.getElementById('date').innerText = data.date;

                    // Set Links
                    document.getElementById('cert-frame').src = `https://drive.google.com/file/d/${data.fileId}/preview`;
                    document.getElementById('btn-profile').href = data.profileUrl || "#"; // Handle empty profile URL
                    document.getElementById('btn-download').href = `https://drive.google.com/u/0/uc?id=${data.fileId}&export=download`;

                    // LinkedIn Integration
                    // This constructs the URL to autofill the LinkedIn "Add Certificate" form
                    const orgName = "Google Developer Groups";
                    const title = "Google Cloud Study Jam Completion";
                    
                    // Note: window.location.href gets the CURRENT page URL to use as verification link
                    const verifyUrl = encodeURIComponent(window.location.href); 
                    
                    const linkedinUrl = `https://www.linkedin.com/profile/add?startTask=CERTIFICATION_NAME&name=${title}&organizationName=${orgName}&issueYear=2025&issueMonth=10&certId=${data.certId}&certUrl=${verifyUrl}`;
                    
                    document.getElementById('btn-linkedin').href = linkedinUrl;

                } else {
                    showError("Invalid Certificate ID. Please check the link.");
                }
            })
            .catch(err => {
                showError("System Error. Please try again later.");
                console.error(err);
            });
    }

    function showError(msg) {
        document.getElementById('loader').classList.add('hidden');
        const errDiv = document.getElementById('error');
        errDiv.innerText = msg;
        errDiv.classList.remove('hidden');
    }
</script>

</body>
</html>